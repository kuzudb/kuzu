-DATASET JSON tinysnb_json
-BUFFER_POOL_SIZE 512000000
--

-CASE TinySnbCopyToJSON
-SKIP_IN_MEM
-STATEMENT COPY (MATCH (p:person) RETURN [id(p)], p.*) TO '${DATABASE_PATH}/tinysnb_person.json'
---- ok
-STATEMENT load from '${DATABASE_PATH}/tinysnb_person.json' return *
---- 8
[0:0]|0|Alice|1|True|False|35|5.000000|1900-01-01|2011-08-20 11:25:30|3 years 2 days 13:02:00|[10,5]|[Aida]|[[10,8],[6,7,8]]|[96,54,86,92]|1.731000|a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11
[0:1]|2|Bob|2|True|False|30|5.100000|1900-01-01|2008-11-03 15:25:30.000526|10 years 5 months 13:00:00.000024|[12,8]|[Bobby]|[[8,9],[9,10]]|[98,42,93,88]|0.990000|a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a12
[0:2]|3|Carol|1|False|True|45|5.000000|1940-06-22|1911-08-20 02:32:21|48:24:11|[4,5]|[Carmen,Fred]|[[8,10]]|[91,75,21,95]|1.000000|a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a13
[0:3]|5|Dan|2|False|True|20|4.800000|1950-07-23|2031-11-30 12:25:30|10 years 5 months 13:00:00.000024|[1,9]|[Wolfeschlegelstein,Daniel]|[[7,4],[8,8],[9]]|[76,88,99,89]|1.300000|a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a14
[0:4]|7|Elizabeth|1|False|True|20|4.700000|1980-10-26|1976-12-23 11:21:42|48:24:11|[2]|[Ein]|[[6],[7],[8]]|[96,59,65,88]|1.463000|a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a15
[0:5]|8|Farooq|2|True|False|25|4.500000|1980-10-26|1972-07-31 13:22:30.678559|00:18:00.024|[3,4,5,6,7]|[Fesdwe]|[[8]]|[80,78,34,83]|1.510000|a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a16
[0:6]|9|Greg|2|False|False|40|4.900000|1980-10-26|1976-12-23 04:41:42|10 years 5 months 13:00:00.000024|[1]|[Grad]|[[10]]|[43,83,67,43]|1.600000|a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a17
[0:7]|10|Hubert Blaine Wolfeschlegelsteinhausenbergerdorff|2|False|True|83|4.900000|1990-11-27|2023-02-21 13:25:30|3 years 2 days 13:02:00|[10,11,12,3,4,5,6,7]|[Ad,De,Hi,Kye,Orlan]|[[7],[10],[6,7]]|[77,64,100,54]|1.323000|a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a18

-STATEMENT COPY (MATCH (m:movies) RETURN m.*) TO '${DATABASE_PATH}/movies.json'
---- ok
-STATEMENT load from '${DATABASE_PATH}/movies.json' return *
---- 3
Sóló cón tu párejâ|126|this is a very very good movie|{rating: 5.300000, stars: 2, views: 152, release: 2011-08-20 11:25:30, release_ns: 2011-08-20 11:25:30.123456, release_ms: 2011-08-20 11:25:30.123, release_sec: 2011-08-20 11:25:30, release_tz: 2011-08-20 11:25:30.123456, film: 2012-05-11, u8: 220, u16: 20, u32: 1, u64: 180, hugedata: 114514}||{audience1: 52, audience53: 42}|True
The 😂😃🧘🏻‍♂️🌍🌦️🍞🚗 movie|2544|the movie is very very good|{rating: 7.000000, stars: 10, views: 982, release: 2018-11-13 13:33:11, release_ns: 2018-11-13 13:33:11.123456, release_ms: 2018-11-13 13:33:11.123, release_sec: 2018-11-13 13:33:11, release_tz: 2018-11-13 13:33:11.123456, film: 2014-09-12, u8: 12, u16: 120, u32: 55, u64: 1, hugedata: 1919810}||{audience1: 33, audience53: }|8.989000
Roma|298|the movie is very interesting and funny|{rating: 1223.000000, stars: 100, views: 10003, release: 2011-02-11 16:44:22, release_ns: 2011-02-11 16:44:22.123456, release_ms: 2011-02-11 16:44:22.123, release_sec: 2011-02-11 16:44:22, release_tz: 2011-02-11 16:44:22.123456, film: 2013-02-22, u8: 1, u16: 15, u32: 200, u64: 4, hugedata: 7210}|pure ascii characters|{audience1: , audience53: }|254.000000

-STATEMENT COPY (RETURN "hi") TO '${DATABASE_PATH}/flattuple.json'
---- ok
-STATEMENT LOAD FROM '${DATABASE_PATH}/flattuple.json' RETURN *
---- 1
hi

-CASE CopyToJsonAllTypeTest
-SKIP_IN_MEM
-STATEMENT load from '${KUZU_ROOT_DIRECTORY}/dataset/all_types/duckdb_all_type_no_inf.csv' return *
---- 2 
False|-128|-32768|-2147483648|-9223372036854775808|-170141183460469231731687303715884105728.000000|0|0|0|0|0|5877642-06-25 (BC)|00:00:00|290309-12-22 (BC) 00:00:00|290309-12-22 (BC) 00:00:00|290309-12-22 (BC) 00:00:00|1677-09-22 00:00:00|00:00:00+15:59:59|290309-12-21 (BC) 18:42:28-05:17|-3.4028235e+38|-1.7976931348623157e+308|-999.9|-99999.9999|-1000000000000.0|-1e+28|00000000-0000-0000-0000-000000000000|00:00:00|thisisalongblob\x00withnullbytes|[]|[]|[]|[]|[]|[]|[]|{a: , b: }|{a: , b: }|[]|{}|Frank|[,2,3]|[a,,c]|[[,2,3],,[,2,3]]|[[a,,c],,[a,,c]]|[{a: , b: },{a: 42, b: 🦆🦆🦆🦆🦆🦆},{a: , b: }]|{a: [,2,3], b: [a,,c]}|[[],[42,999,,,-42],[]]|[[,2,3],[4,5,6],[,2,3]]
True|127|32767|2147483647|9223372036854775807|170141183460469231731687303715884105728.000000|340282366920938463463374607431768211455|255|65535|4294967295|18446744073709551615|5881580-07-10|24:00:00|294247-01-10 04:00:54.775806|294247-01-10 04:00:54|294247-01-10 04:00:54.775|2262-04-11 23:47:16.854775|24:00:00-15:59:59|294247-01-09 23:00:54.776806-05|3.4028235e+38|1.7976931348623157e+308|999.9|99999.9999|1000000000000.0|1e+28|ffffffff-ffff-ffff-ffff-ffffffffffff|83 years 3 months 999 days 00:16:39.999999|\x00\x00\x00a|[42,999,,,-42]|[42.0,,,-42.0]|[1970-01-01,,2022-05-12]|[1970-01-01 00:00:00,,2022-05-12 16:23:45]|[1970-01-01 00:00:00,,2022-05-12 23:23:45]|[🦆🦆🦆🦆🦆🦆,goose,,]|[[],[42,999,,,-42],,[],[42,999,,,-42]]|{a: 42, b: 🦆🦆🦆🦆🦆🦆}|{a: [42,999,,,-42], b: [🦆🦆🦆🦆🦆🦆,goose,,]}|[{a: , b: },{a: 42, b: 🦆🦆🦆🦆🦆🦆},]|{key1=🦆🦆🦆🦆🦆🦆, key2=goose}|5|[4,5,6]|[d,e,f]|[[4,5,6],[,2,3],[4,5,6]]|[[d,e,f],[a,,c],[d,e,f]]|[{a: 42, b: 🦆🦆🦆🦆🦆🦆},{a: , b: },{a: 42, b: 🦆🦆🦆🦆🦆🦆}]|{a: [4,5,6], b: [d,e,f]}|[[42,999,,,-42],[],[42,999,,,-42]]|[[4,5,6],[,2,3],[4,5,6]]
-STATEMENT COPY (load from '${KUZU_ROOT_DIRECTORY}/dataset/all_types/duckdb_all_type_no_inf.csv' return *) TO "${DATABASE_PATH}/all_types.json"
---- ok

-STATEMENT load from '${DATABASE_PATH}/all_types.json' RETURN *
---- 2
False|-128|-32768|-2147483648|-9223372036854775808|-170141183460469231731687303715884105728.000000|0|0|0|0|0|5877642-06-25 (BC)|00:00:00|290309-12-22 (BC) 00:00:00|290309-12-22 (BC) 00:00:00|290309-12-22 (BC) 00:00:00|1677-09-22 00:00:00|00:00:00+15:59:59|290309-12-21 (BC) 18:42:28-05:17|-3.4028235e+38|-1.7976931348623157e+308|-999.9|-99999.9999|-1000000000000.0|-1e+28|00000000-0000-0000-0000-000000000000|00:00:00|thisisalongblob\x00withnullbytes|[]|[]|[]|[]|[]|[]|[]|{a: , b: }|{a: , b: }|[]|{key1: , key2: }|Frank|[,2,3]|[a,,c]|[[,2,3],,[,2,3]]|[[a,,c],,[a,,c]]|[{a: , b: },{a: 42, b: 🦆🦆🦆🦆🦆🦆},{a: , b: }]|{a: [,2,3], b: [a,,c]}|[[],[42,999,,,-42],[]]|[[,2,3],[4,5,6],[,2,3]]
True|127|32767|2147483647|9223372036854775807|170141183460469231731687303715884105728.000000|340282366920938463463374607431768211455|255|65535|4294967295|18446744073709551615|5881580-07-10|24:00:00|294247-01-10 04:00:54.775806|294247-01-10 04:00:54|294247-01-10 04:00:54.775|2262-04-11 23:47:16.854775|24:00:00-15:59:59|294247-01-09 23:00:54.776806-05|3.4028235e+38|1.7976931348623157e+308|999.9|99999.9999|1000000000000.0|1e+28|ffffffff-ffff-ffff-ffff-ffffffffffff|83 years 3 months 999 days 00:16:39.999999|\x00\x00\x00a|[42,999,,,-42]|[42.0,,,-42.0]|[1970-01-01,,2022-05-12]|[1970-01-01 00:00:00,,2022-05-12 16:23:45]|[1970-01-01 00:00:00,,2022-05-12 23:23:45]|[🦆🦆🦆🦆🦆🦆,goose,,]|[[],[42,999,,,-42],,[],[42,999,,,-42]]|{a: 42, b: 🦆🦆🦆🦆🦆🦆}|{a: [42,999,,,-42], b: [🦆🦆🦆🦆🦆🦆,goose,,]}|[{a: , b: },{a: 42, b: 🦆🦆🦆🦆🦆🦆},]|{key1: 🦆🦆🦆🦆🦆🦆, key2: goose}|5|[4,5,6]|[d,e,f]|[[4,5,6],[,2,3],[4,5,6]]|[[d,e,f],[a,,c],[d,e,f]]|[{a: 42, b: 🦆🦆🦆🦆🦆🦆},{a: , b: },{a: 42, b: 🦆🦆🦆🦆🦆🦆}]|{a: [4,5,6], b: [d,e,f]}|[[42,999,,,-42],[],[42,999,,,-42]]|[[4,5,6],[,2,3],[4,5,6]]