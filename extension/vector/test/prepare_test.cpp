#include "api_test/api_test.h"

using namespace kuzu::common;

namespace kuzu {
namespace testing {

TEST_F(ApiTest, PrepareVectorKTest) {
#ifndef __STATIC_LINK_EXTENSION_TEST__
    ASSERT_TRUE(conn->query(common::stringFormat("LOAD EXTENSION '{}'",
                                TestHelper::appendKuzuRootPath(
                                    "extension/vector/build/libvector.kuzu_extension")))
                    ->isSuccess());
#endif
    ASSERT_TRUE(conn->query("CREATE NODE TABLE Book (ID SERIAL, title STRING, published_year "
                            "INT64,title_embedding FLOAT[384],PRIMARY KEY (ID));")
                    ->isSuccess());
    ASSERT_TRUE(conn->query("CREATE (b:Book {title: 'The Quantum World', published_year: 2005, "
                            "title_embedding: [-0.08304852247238159, -0.02058534137904644, "
                            "-0.05093800276517868, 0.03479359671473503, -0.1181315928697586, "
                            "-0.022585440427064896, 0.000689070438966155, -0.04571826756000519, "
                            "0.011306585744023323, -0.031156184151768684, 0.056711968034505844, "
                            "-0.06878629326820374, -0.028948040679097176, 0.039227377623319626, "
                            "-0.024016236886382103, -0.006018369924277067, -0.011686236597597599, "
                            "-0.06417948752641678, -0.08726289868354797, -0.051262110471725464, "
                            "0.010797271504998207, -0.004546730313450098, 0.007328123319894075, "
                            "0.032176729291677475, 0.010629404336214066, 0.009314212016761303, "
                            "0.08034229278564453, -0.0056989057920873165, 0.06931845843791962, "
                            "-0.05362297594547272, 0.04066690430045128, 0.06261419504880905, "
                            "0.009296746924519539, -0.027845263481140137, 0.004991820547729731, "
                            "0.029851600527763367, 0.01690305955708027, -0.019055698066949844, "
                            "0.05507630482316017, -0.018174298107624054, 0.0065305596217513084, "
                            "0.011707584373652935, -0.04950123280286789, 0.01574806123971939, "
                            "0.003966356161981821, 0.044103045016527176, 0.06040499359369278, "
                            "0.01077649649232626, -0.057096242904663086, -0.08496285229921341, "
                            "-0.04497399553656578, 0.025748439133167267, -0.009737248532474041, "
                            "0.026926059275865555, 0.0829956978559494, 0.03719377517700195, "
                            "0.07925762236118317, -0.028637833893299103, -0.05194134637713432, "
                            "-0.1099226325750351, -0.037101101130247116, -0.036725495010614395, "
                            "-0.0382792130112648, 0.05444488301873207, 0.19726459681987762, "
                            "0.020997796207666397, -0.01592053286731243, 0.06538064777851105, "
                            "-0.012968834489583969, 0.0062084924429655075, -0.03842926770448685, "
                            "-0.020584281533956528, -0.016336286440491676, 0.0342116616666317, "
                            "0.08500388264656067, -0.057907383888959885, 0.03329908847808838, "
                            "0.04087410867214203, 0.08091093599796295, 0.11162354797124863, "
                            "0.04277801886200905, -0.12173154950141907, -0.02084791474044323, "
                            "0.06534168869256973, 0.025396408513188362, 0.01698037050664425, "
                            "-0.05053079128265381, -0.02342156320810318, -0.06318697333335876, "
                            "-0.06993686407804489, -0.08303093910217285, -0.09778174757957458, "
                            "-0.007213875185698271, -0.0007251176284626126, -0.006016636732965708, "
                            "0.024347547441720963, 0.05141201242804527, -0.03679395094513893, "
                            "0.045402538031339645, 0.08500991016626358, 0.11084073036909103, "
                            "-0.0005619092262350023, 0.00017974706133827567, 0.03402278944849968, "
                            "0.033157944679260254, 0.013885957188904285, 0.006286433897912502, "
                            "0.0210332702845335, 0.009642603807151318, -0.0015390089247375727, "
                            "0.006029923912137747, -0.033495839685201645, 0.036467358469963074, "
                            "-0.030008403584361076, -0.018402274698019028, -0.04245299845933914, "
                            "0.0576760433614254, 0.147276371717453, -0.03709825500845909, "
                            "-0.019318850710988045, -0.0033551156520843506, 0.0278102345764637, "
                            "-0.0023694040719419718, 0.0815303847193718, -0.03575475513935089, "
                            "0.010088955983519554, -0.06867044419050217, -5.1213295028152316e-33, "
                            "0.04189286008477211, -0.032489556819200516, 0.07230721414089203, "
                            "0.03830070048570633, 0.07021922618150711, 0.031608037650585175, "
                            "0.02875831164419651, -0.06413885951042175, -0.0024398155510425568, "
                            "-0.03807589411735535, -0.003005875740200281, 0.031127819791436195, "
                            "0.041010789573192596, -0.0005872542969882488, 0.05330154299736023, "
                            "0.03109973855316639, -0.08356324583292007, 0.0011609029024839401, "
                            "0.06657204031944275, 0.02624146267771721, -0.0015171350678429008, "
                            "0.021294476464390755, -0.09065696597099304, -0.003927781246602535, "
                            "-0.038948167115449905, -0.004068801179528236, 0.07121506333351135, "
                            "-0.0017770330887287855, -0.029500851407647133, 0.0022221128456294537, "
                            "-0.015435103327035904, 0.11576546728610992, -0.10700841248035431, "
                            "-0.02528359182178974, 0.01918620802462101, 0.026469726115465164, "
                            "-0.0039527444168925285, 0.0007155033526942134, -0.044153738766908646, "
                            "-0.09781449288129807, -0.03857731819152832, -0.0027703430969268084, "
                            "0.026768159121274948, -0.036691680550575256, 0.020277034491300583, "
                            "-0.007407037541270256, 0.05908101052045822, -0.019854627549648285, "
                            "0.003975669853389263, 0.02608686499297619, 0.01815151236951351, "
                            "-0.06416855752468109, -0.06370945274829865, -0.0005957877147011459, "
                            "0.08855710923671722, -0.019311748445034027, 0.052521202713251114, "
                            "0.04054408147931099, -0.014436084777116776, 0.06384889036417007, "
                            "-0.027137264609336853, 0.008217060007154942, 0.0022059865295886993, "
                            "0.058661237359046936, -0.004328707233071327, 0.02439774014055729, "
                            "-0.045767512172460556, -0.09047109633684158, 0.007579886820167303, "
                            "0.09357533603906631, -0.05882526934146881, 0.06190042942762375, "
                            "0.0513124093413353, -0.029035242274403572, 0.09877828508615494, "
                            "-0.058560509234666824, 0.006568029522895813, -0.049481671303510666, "
                            "-0.027936115860939026, 0.016179615631699562, -0.012940192595124245, "
                            "-0.05337012559175491, -0.017763571813702583, 0.01831825077533722, "
                            "-0.025164643302559853, -0.07102911174297333, -0.05184098705649376, "
                            "-0.08271463960409164, -0.01213726308196783, 0.011826423928141594, "
                            "-0.09991900622844696, -0.050111863762140274, 0.10658092796802521, "
                            "-0.010411638766527176, -0.10244571417570114, 3.418246838721008e-33, "
                            "-0.09974873811006546, -0.02856418304145336, -0.007222364656627178, "
                            "0.025535948574543, 0.007615517359226942, -0.019846700131893158, "
                            "-0.06695008277893066, -0.006421900354325771, -0.03672897815704346, "
                            "0.04667169600725174, 0.06146642565727234, 0.05907291918992996, "
                            "0.10363762080669403, 0.03894611448049545, -0.0031130025163292885, "
                            "0.020608579739928246, 0.08486811071634293, -0.05163326486945152, "
                            "0.0332440622150898, -0.012025050818920135, 0.0664721354842186, "
                            "-0.06872405856847763, -0.020568856969475746, -0.057556506246328354, "
                            "0.024705618619918823, 0.12362422049045563, 0.07590771466493607, "
                            "-0.02632792852818966, 0.03537701442837715, 0.015069843269884586, "
                            "-0.019497649744153023, -0.09571782499551773, -0.07784656435251236, "
                            "0.007147111464291811, -0.09032715857028961, 0.018374057486653328, "
                            "0.021843796595931053, 0.07942599803209305, -0.04640636965632439, "
                            "-0.07724650949239731, -0.0710376501083374, 0.01247443724423647, "
                            "-0.03992825001478195, 0.034849684685468674, -0.008109445683658123, "
                            "-0.021737558767199516, -0.041551847010850906, 0.04097175970673561, "
                            "-0.06579674780368805, -0.0005798917845822871, -0.030350863933563232, "
                            "0.0660700798034668, 0.05671687424182892, -0.014442390762269497, "
                            "-0.08820260316133499, 0.07568715512752533, -0.04957274720072746, "
                            "0.04357157647609711, 0.12032957375049591, 0.0719781219959259, "
                            "-0.04597806558012962, -0.0007544226828031242, 0.01472271978855133, "
                            "0.11872826516628265, -0.030990950763225555, -0.04826083779335022, "
                            "-0.066269651055336, 0.09913164377212524, 0.013303411193192005, "
                            "-0.08914417773485184, -0.008007648400962353, 0.021501826122403145, "
                            "-0.04871877282857895, -0.03298939764499664, 0.04915677756071091, "
                            "0.07495952397584915, 0.02460429258644581, -0.034788817167282104, "
                            "0.04378701001405716, 0.018943151459097862, 0.03162635490298271, "
                            "0.022808877751231194, 0.025081634521484375, 0.030960656702518463, "
                            "0.020125605165958405, -0.0028618176002055407, 0.0033752291928976774, "
                            "0.008664743974804878, -0.011685301549732685, -0.07076402008533478, "
                            "6.948200461920351e-05, 0.029294446110725403, -0.04594152793288231, "
                            "-0.03563579544425011, -0.01344709936529398, -1.1639772701244055e-08, "
                            "-0.003855546237900853, -0.0006962644984014332, -0.020182238891720772, "
                            "0.002405841602012515, 0.0769188404083252, 0.02334100753068924, "
                            "0.08726540952920914, -0.00426120450720191, -0.07040005922317505, "
                            "0.030403442680835724, 0.03111386112868786, 0.00472688302397728, "
                            "-0.060386527329683304, 0.06969817727804184, 0.04356810823082924, "
                            "0.025495927780866623, -0.07030773907899857, -0.06392610818147659, "
                            "-0.005889120511710644, 0.05826268717646599, 0.0783243328332901, "
                            "0.02981630153954029, 0.0483536534011364, 0.012051032856106758, "
                            "-0.06730472296476364, 0.002232621656730771, 0.004913295153528452, "
                            "-0.042151592671871185, -0.027799151837825775, 0.008324205875396729, "
                            "-0.01811189018189907, 0.03209993988275528, 0.036988094449043274, "
                            "0.061422523111104965, -0.1250476837158203, -0.07703979313373566, "
                            "-0.07750312238931656, -0.00862059649080038, -0.011400929652154446, "
                            "0.05365646630525589, -0.05456509813666344, 0.036588046699762344, "
                            "-0.025964785367250443, 0.048956409096717834, 0.06672573834657669, "
                            "0.01986047253012657, 0.026083579286932945, -0.029424510896205902, "
                            "0.04935725778341293, 0.08432748168706894, -0.06502088159322739, "
                            "0.05082103982567787, 0.02615153230726719, -0.09470940381288528, "
                            "-0.01509593054652214, 0.04131824150681496, -0.04847507178783417, "
                            "-0.030596941709518433, -0.07693798840045929, 0.0670684427022934, "
                            "0.06115403026342392, -0.01113433763384819, -0.015445088967680931, "
                            "0.01863049529492855]});")
                    ->isSuccess());
    ASSERT_TRUE(
        conn->query("CREATE (b:Book {title: 'Chronicles of the Universe', published_year: 2022, "
                    "title_embedding: [-0.07210252434015274, -0.017251353710889816, "
                    "0.0022830592934042215, 0.03491438925266266, -0.054226603358983994, "
                    "0.019960463047027588, -0.05079013109207153, -0.0424049012362957, "
                    "0.11433924734592438, -0.02415328100323677, -0.032670941203832626, "
                    "-0.030510129407048225, -0.011228509247303009, 0.035822827368974686, "
                    "-0.014074163511395454, -0.05791621655225754, -0.0007832227856852114, "
                    "-0.047769930213689804, 0.036213263869285583, -0.12925361096858978, "
                    "-0.01094720046967268, 0.0858682319521904, -0.0278758741915226, "
                    "0.004604768939316273, -0.0034155775792896748, -0.03611735999584198, "
                    "0.009392675943672657, 0.02149505726993084, -0.027692623436450958, "
                    "-0.056750696152448654, -0.01626468636095524, 0.036573249846696854, "
                    "-0.08991283923387527, -0.020649494603276253, -0.01443167869001627, "
                    "0.004353889264166355, -0.03332004323601723, -0.05342397466301918, "
                    "0.003913808614015579, 0.00500855129212141, -0.024330290034413338, "
                    "0.010117631405591965, -0.024611152708530426, 0.014346317388117313, "
                    "0.007086708676069975, 0.007350274361670017, -0.027451323345303535, "
                    "-0.0592990517616272, 0.06631831079721451, 0.08694759011268616, "
                    "-0.07635203748941422, 0.013416293077170849, 0.013307900168001652, "
                    "0.018931938335299492, 0.10020309686660767, -0.00048431483446620405, "
                    "-0.02270045503973961, -0.09432774782180786, 0.05044231563806534, "
                    "-0.12029903382062912, 0.03510391712188721, -0.0767797902226448, "
                    "-0.033482350409030914, 0.012507965788245201, 0.046030979603528976, "
                    "-0.05386075749993324, 0.001833413727581501, 0.08401170372962952, "
                    "0.013885472901165485, -0.08262883871793747, -0.13932575285434723, "
                    "0.05426040664315224, 0.04644002392888069, 0.039168793708086014, "
                    "0.03425360471010208, -0.00031453039264306426, -0.017616458237171173, "
                    "-0.11215370148420334, 0.0040164305828511715, -0.012427037581801414, "
                    "0.014006994664669037, -0.04630516469478607, -0.10298219323158264, "
                    "0.03049636259675026, -0.02952263318002224, -0.004199012648314238, "
                    "0.013636204414069653, -0.053503651171922684, -0.04717779904603958, "
                    "-0.006719975266605616, -0.010238864459097385, -0.06871801614761353, "
                    "0.13965067267417908, 0.04075661301612854, -0.11393355578184128, "
                    "0.09633657336235046, 0.002745254198089242, -0.05706354230642319, "
                    "0.07464960962533951, 0.12428409606218338, 0.0655185729265213, "
                    "-0.10802365839481354, 0.011580080725252628, 0.044843241572380066, "
                    "0.09965775907039642, -0.015024986118078232, 0.018429087474942207, "
                    "-0.025123165920376778, -0.01969185657799244, -0.03091134876012802, "
                    "0.004741166718304157, -0.04404812678694725, -0.03643517568707466, "
                    "-0.022292500361800194, 0.003334848675876856, -0.024964675307273865, "
                    "0.15225404500961304, 0.08205278217792511, -0.03532726690173149, "
                    "0.05858049914240837, 0.05922678858041763, 0.043336715549230576, "
                    "0.030355188995599747, -0.0276491679251194, 0.0007490332354791462, "
                    "-0.04251508042216301, 0.043555788695812225, -4.9317751612733836e-33, "
                    "0.023551004007458687, -0.046149175614118576, 0.016909394413232803, "
                    "0.05091489851474762, 0.08386256545782089, -0.016755426302552223, "
                    "0.0027511166408658028, 0.07013880461454391, -0.05874364823102951, "
                    "-0.0010957462945953012, -0.01684780977666378, 0.05796954408288002, "
                    "-0.019690347835421562, -0.049311283975839615, -0.0009851971408352256, "
                    "0.006537716370075941, -0.012777800671756268, 0.038791902363300323, "
                    "0.04083215817809105, 0.011430979706346989, -0.03279244899749756, "
                    "0.0740056186914444, -0.02843477576971054, -0.023564670234918594, "
                    "-0.013206686824560165, -0.06532252579927444, 0.048933763056993484, "
                    "-0.022634733468294144, 0.019633183255791664, 0.03333616629242897, "
                    "-0.0032200845889747143, 0.031874556094408035, -0.04005168750882149, "
                    "-0.03501356393098831, -0.003541751764714718, -0.021530169993638992, "
                    "-0.03765172138810158, -0.0350797101855278, 0.020378204062581062, "
                    "0.008442549966275692, -0.014197328127920628, 0.06646192818880081, "
                    "-0.029866985976696014, -0.03589841350913048, -0.05392972379922867, "
                    "0.0798153206706047, 0.08046967536211014, 0.009289469569921494, "
                    "-0.06704642623662949, 0.12246246635913849, 0.001821666257455945, "
                    "-0.030365880578756332, -0.05145755410194397, 0.005446379538625479, "
                    "-0.02757429890334606, 0.015921931713819504, -0.005903041921555996, "
                    "-0.0005513069918379188, 0.02831243723630905, 0.03678856045007706, "
                    "0.03206786885857582, 0.01806008443236351, 0.059262774884700775, "
                    "0.06834858655929565, 0.018178995698690414, 0.014817757532000542, "
                    "0.06258685141801834, -0.010000851936638355, -0.018919197842478752, "
                    "0.02703644149005413, -0.08447106182575226, 0.013583207502961159, "
                    "0.11275676637887955, -0.00446569686755538, 0.0563526377081871, "
                    "-0.0452260784804821, -0.010196822695434093, 0.019870400428771973, "
                    "-0.11798244714736938, -0.036394085735082626, -0.05552973598241806, "
                    "-0.014338533394038677, -0.012777158990502357, 0.018296660855412483, "
                    "0.0029506725259125233, -0.018329761922359467, -0.017499782145023346, "
                    "0.007904408499598503, 0.04313542693853378, -0.1568812131881714, "
                    "0.010871184058487415, -0.0245852991938591, 0.11773289740085602, "
                    "-0.06497083604335785, -0.06916026026010513, 4.098107955514494e-33, "
                    "0.03281199559569359, -0.02659011445939541, 3.126651427010074e-05, "
                    "-0.03836091607809067, 0.07914025336503983, 0.05641584098339081, "
                    "-0.06693574786186218, 0.04327169433236122, -0.0777413621544838, "
                    "-0.015299541875720024, -0.008854963816702366, -0.006491665728390217, "
                    "0.020671626552939415, -0.030588146299123764, 0.06110672652721405, "
                    "-0.033647824078798294, 0.041133519262075424, -0.054605673998594284, "
                    "0.016890140250325203, 0.06993326544761658, 0.014330688863992691, "
                    "-0.10271874070167542, -0.021457117050886154, -0.07777834683656693, "
                    "0.08780306577682495, 0.055652227252721786, 0.022181812673807144, "
                    "-0.029305648058652878, -0.08919937163591385, 0.06990376114845276, "
                    "0.012307574041187763, -0.02522643841803074, -0.027082521468400955, "
                    "0.013585182838141918, -0.044919438660144806, 0.018855644389986992, "
                    "0.08398288488388062, 0.02031307853758335, -0.07800983637571335, "
                    "-0.0391533300280571, 0.011272098869085312, 0.061281703412532806, "
                    "0.0004483219236135483, 0.11526276916265488, -0.05068649724125862, "
                    "-0.03429318964481354, 0.028343910351395607, 0.07163633406162262, "
                    "-0.02841690368950367, 0.025470245629549026, -0.07658354192972183, "
                    "-0.016233688220381737, 0.0514676459133625, -0.06280016899108887, "
                    "-0.028401406481862068, 0.007418257184326649, 0.024311332032084465, "
                    "0.0861428752541542, 0.04640772566199303, 0.041435595601797104, "
                    "-0.058609552681446075, -0.020394472405314445, 0.04024171829223633, "
                    "0.0009873795788735151, -0.009043966419994831, -0.015515996143221855, "
                    "-0.013613858260214329, -0.0067819287069141865, 0.001332683372311294, "
                    "-0.03121822699904442, -0.04911128431558609, 0.022500010207295418, "
                    "-0.06003386154770851, -0.09877979755401611, 0.03851510211825371, "
                    "0.06778870522975922, 0.05914377421140671, -0.04920419678092003, "
                    "0.02466065064072609, 0.018606020137667656, -0.00639603054150939, "
                    "-0.01634073816239834, 0.019756454974412918, 0.09565513581037521, "
                    "0.05985594168305397, 0.049195319414138794, 0.017827700823545456, "
                    "0.009785362519323826, 0.01559488009661436, -0.006651966832578182, "
                    "0.02074417658150196, -0.03646905720233917, 0.025536462664604187, "
                    "-0.05086643621325493, 0.051975395530462265, -1.3323923298003137e-08, "
                    "0.0038988629821687937, 0.028620507568120956, -0.09146521240472794, "
                    "-0.005849150009453297, 0.0011782789370045066, 0.026700150221586227, "
                    "-0.0026575811207294464, 0.06278374046087265, -0.028294462710618973, "
                    "0.13136377930641174, 0.06709709763526917, 0.05132691189646721, "
                    "0.023583602160215378, 0.08689919859170914, -0.021221768110990524, "
                    "0.0718538910150528, 0.06095081567764282, 0.007474739570170641, "
                    "-0.042592938989400864, 0.07760557532310486, 0.0574176087975502, "
                    "0.02471820078790188, 0.0745280459523201, -0.0649210587143898, "
                    "-0.003153957659378648, 0.03567073121666908, -0.040897443890571594, "
                    "-0.08714345842599869, 0.04990929365158081, 0.002536991611123085, "
                    "0.020591333508491516, 0.024597475305199623, -0.11251061409711838, "
                    "-0.00800512358546257, -0.050928328186273575, -0.06076308339834213, "
                    "-0.013323506340384483, 0.011378155089914799, 0.017900964245200157, "
                    "-0.014109048992395401, 0.09931034594774246, 0.08495353907346725, "
                    "-0.013475373387336731, 0.03732695057988167, -0.0006989945541135967, "
                    "-0.005354566033929586, 0.06368720531463623, 3.036053203686606e-05, "
                    "0.002757550682872534, -0.009319699369370937, 0.022985178977251053, "
                    "0.011624203063547611, 0.003140172455459833, -0.04846913740038872, "
                    "0.026750877499580383, 0.011968350037932396, -0.06409432739019394, "
                    "0.04462873190641403, -0.09777524322271347, 0.019800350069999695, "
                    "0.1431092917919159, -0.06282920390367508, 0.001956850290298462, "
                    "-0.054147545248270035]});")
            ->isSuccess());
    ASSERT_TRUE(conn->query("CREATE (b:Book {title: 'Learning Machines', published_year: 2025, "
                            "title_embedding: [-0.049301233142614365, -0.046188145875930786, "
                            "0.03472346067428589, 0.0064525725319981575, -0.004189625848084688, "
                            "-0.003049291670322418, 0.04592432454228401, -0.04463763162493706, "
                            "-0.043617021292448044, -0.055165596306324005, -0.009703222662210464, "
                            "-0.0018872314831241965, 0.06216295808553696, 0.007725407835096121, "
                            "-0.046801965683698654, 0.018362119793891907, 0.030891576781868935, "
                            "0.03837413340806961, -0.09633796662092209, -0.08737432211637497, "
                            "-0.03976738825440407, 0.019953912124037743, -0.03183538094162941, "
                            "0.012102929875254631, 0.047513771802186966, 0.04056912660598755, "
                            "0.026109376922249794, 0.08548211306333542, 0.007492062170058489, "
                            "-0.0891815647482872, 0.0005767130060121417, -0.06575367599725723, "
                            "-0.016490092501044273, 0.05413990467786789, -0.09993062913417816, "
                            "0.006903850939124823, -0.06292737275362015, 0.05344223231077194, "
                            "0.002784632844850421, 0.04595203697681427, 0.003288567066192627, "
                            "-0.07509408891201019, 0.02712966874241829, 0.005801369436085224, "
                            "0.09765485674142838, 0.09233157336711884, 4.955035910825245e-05, "
                            "-0.0181678906083107, -0.01896655559539795, 0.05687593296170235, "
                            "-0.11144442111253738, -0.010457410477101803, -0.016893846914172173, "
                            "0.03392044082283974, -0.07276374846696854, -0.003815167583525181, "
                            "0.01686347834765911, 0.010918785817921162, 0.028089508414268494, "
                            "0.005089984275400639, 0.04611951485276222, -0.11454106867313385, "
                            "-0.11474697291851044, -0.008716493844985962, 0.06815969198942184, "
                            "0.04933328181505203, 0.013492020778357983, 0.04086754098534584, "
                            "-0.05385364964604378, -0.036715760827064514, -0.029824869707226753, "
                            "0.028561457991600037, -0.027426807209849358, 0.047513194382190704, "
                            "0.027790144085884094, -0.01013938244432211, 0.06792810559272766, "
                            "0.03392220288515091, 0.040242940187454224, -0.021049534901976585, "
                            "-0.06674943119287491, -0.03747761994600296, 0.0020319370087236166, "
                            "0.06924799829721451, 0.08775348961353302, -0.007186089176684618, "
                            "-0.02613702230155468, 0.039398059248924255, -0.0360381156206131, "
                            "-0.03319856524467468, 0.0037813882809132338, -0.04233044758439064, "
                            "0.056168921291828156, -0.06484966725111008, -0.07821447402238846, "
                            "0.04835423082113266, -0.007883965037763119, -0.13460788130760193, "
                            "-0.021979881450533867, 0.21439237892627716, -0.023854805156588554, "
                            "0.050453539937734604, 0.01597166620194912, 0.008138520643115044, "
                            "0.010824039578437805, 0.008995733223855495, 0.004696813877671957, "
                            "0.023806633427739143, 0.090768001973629, -0.10269339382648468, "
                            "-0.04043365269899368, -0.01037873886525631, -0.016198161989450455, "
                            "-0.06482957303524017, 0.04042404145002365, -0.08649348467588425, "
                            "0.0508313849568367, -0.006347178481519222, -0.017155952751636505, "
                            "0.057533975690603256, -0.04024622589349747, -0.029563255608081818, "
                            "0.006724941078573465, 0.059689074754714966, 0.005109780468046665, "
                            "-0.028722820803523064, -0.06887400895357132, -5.005795856873671e-34, "
                            "0.026128899306058884, -0.04934206232428551, 0.049172572791576385, "
                            "0.03440887853503227, 0.03331339359283447, -0.04760875552892685, "
                            "-0.030767157673835754, -0.01592785120010376, 0.06388265639543533, "
                            "-0.001630802871659398, -0.05780549719929695, 0.0314568467438221, "
                            "-0.013306870125234127, -0.003627052530646324, 0.11984001845121384, "
                            "-0.04549394175410271, 0.032732170075178146, 0.09205213934183121, "
                            "-0.02503153122961521, -0.010541357100009918, 0.006997185759246349, "
                            "-0.04611791670322418, 0.06505294889211655, -0.03752365708351135, "
                            "-0.03203354775905609, 0.009107643738389015, 0.036092713475227356, "
                            "-0.022758014500141144, -0.012543360702693462, 0.02072984352707863, "
                            "0.04123224690556526, 0.016621828079223633, -0.027517300099134445, "
                            "0.03911050781607628, 0.03250284120440483, 0.014664123766124249, "
                            "-0.010003898292779922, 0.01520220935344696, 0.09108687192201614, "
                            "-0.0431206114590168, -0.04104820266366005, -0.044938523322343826, "
                            "0.0871610939502716, 0.013578345999121666, -0.04319895803928375, "
                            "0.024108752608299255, -0.002946235937997699, -0.09317304939031601, "
                            "-0.02253129333257675, -0.018337076529860497, 0.013640434481203556, "
                            "-0.006322886794805527, -0.10937284678220749, -0.011331189423799515, "
                            "0.06590068340301514, 0.09703978151082993, -0.012287620455026627, "
                            "0.012317735701799393, -0.013109935447573662, -0.032738085836172104, "
                            "0.08151600509881973, 0.07043878734111786, 0.01512476708739996, "
                            "-0.00374302314594388, -0.01843378320336342, 0.01714075542986393, "
                            "0.012261425144970417, -0.02309505082666874, 0.03849336504936218, "
                            "0.01849987916648388, 0.01091696135699749, 0.002837016247212887, "
                            "0.043384481221437454, -0.03943859413266182, 0.036433760076761246, "
                            "0.08604861050844193, 0.0003242302918806672, -0.006549411453306675, "
                            "-0.04385951906442642, 0.013515549711883068, -0.07300501316785812, "
                            "-0.03192663565278053, 0.0050736176781356335, -0.0388711541891098, "
                            "-0.051676325500011444, -0.06993497163057327, -0.0005253818817436695, "
                            "-0.05314437299966812, -0.0037047346122562885, 0.04119967296719551, "
                            "-0.13491754233837128, 0.02226193994283676, 0.0518956296145916, "
                            "0.02546105533838272, -0.1134718582034111, 1.2758344567729818e-33, "
                            "-0.12524108588695526, 0.06478261947631836, 0.023791471496224403, "
                            "0.11100995540618896, -0.021018588915467262, 0.008467867970466614, "
                            "-0.0718110054731369, 0.021032381802797318, -0.03490489721298218, "
                            "0.0681171789765358, -0.00041216539102606475, 0.059914037585258484, "
                            "0.05707279592752457, -0.0036985017359256744, -0.05980902910232544, "
                            "0.0698259100317955, 0.022090116515755653, -0.0015257132472470403, "
                            "-0.002844851464033127, 0.041666001081466675, -0.04496299847960472, "
                            "0.07835614681243896, -0.03123178333044052, 0.030638128519058228, "
                            "-0.04172713682055473, 0.010804410092532635, -0.03649225831031799, "
                            "0.017629485577344894, -0.03378402814269066, -0.024500316008925438, "
                            "-0.018430041149258614, -0.0575583353638649, -0.05029042065143585, "
                            "0.07616154849529266, -0.03707257658243179, 0.0063291145488619804, "
                            "-0.017812274396419525, 0.03936947137117386, -0.02636144310235977, "
                            "0.09530747681856155, 0.026665018871426582, 0.06481663882732391, "
                            "-0.08628968149423599, -0.008002087473869324, -0.043672170490026474, "
                            "-0.11783511191606522, -0.046256523579359055, 0.02761153131723404, "
                            "0.0145292142406106, -0.03743415325880051, -0.027222860604524612, "
                            "0.03343577682971954, -0.04676775634288788, -0.04530837759375572, "
                            "-0.04328890144824982, -0.001857980154454708, -0.012224056757986546, "
                            "-0.037044819444417953, 0.025376394391059875, 0.046211544424295425, "
                            "-0.1362127810716629, -0.04962705820798874, -0.03459205478429794, "
                            "0.0705024003982544, -0.023510191589593887, -0.032222602516412735, "
                            "-0.013089868240058422, 0.06917420774698257, 0.0021111569367349148, "
                            "-0.0008641202584840357, 0.0478396937251091, 0.048147547990083694, "
                            "0.0074039604514837265, 0.007188139483332634, -0.025762449949979782, "
                            "-0.03082682564854622, -0.03878726437687874, -0.05010513961315155, "
                            "-0.020779557526111603, -0.04614514112472534, -0.00036191748222336173, "
                            "-0.049597617238759995, 0.038655512034893036, 0.13685840368270874, "
                            "0.015613874420523643, 0.07553302496671677, 0.09875340014696121, "
                            "-0.017702536657452583, 0.06808372586965561, -0.03611382469534874, "
                            "0.02666141837835312, 0.08950337767601013, 0.04053311422467232, "
                            "0.017930379137396812, -0.06859979778528214, -1.1845766145768266e-08, "
                            "-0.03814923018217087, -0.04463006183505058, 0.07016224414110184, "
                            "0.02655915543437004, 0.03730274364352226, -0.0008403793908655643, "
                            "-0.08449027687311172, 0.08698073774576187, -0.03673301264643669, "
                            "-0.01609956845641136, 0.069426529109478, 0.03272199258208275, "
                            "0.008170858025550842, 0.03791160136461258, -0.005906472448259592, "
                            "0.024195916950702667, 0.047408949583768845, 0.08452270179986954, "
                            "-0.009813494049012661, 0.017480526119470596, 0.10508622974157333, "
                            "0.04488841071724892, 0.06670865416526794, 0.05332706496119499, "
                            "0.09634494036436081, -0.06312766671180725, 0.016334734857082367, "
                            "0.06042300537228584, 0.007927890866994858, 0.12235202640295029, "
                            "-0.053554508835077286, 0.07745878398418427, 0.017651937901973724, "
                            "-0.01956999860703945, 0.09754553437232971, 0.02822352945804596, "
                            "0.0038486532866954803, -0.06202001869678497, -0.03347748890519142, "
                            "0.03281448036432266, -0.01998397335410118, 0.03916510194540024, "
                            "-0.08087446540594101, 0.00812716968357563, 0.018631942570209503, "
                            "0.02199832908809185, 0.02088017761707306, -0.151823028922081, "
                            "-0.003114311723038554, 0.0026487219147384167, 0.02042154222726822, "
                            "0.016444552689790726, 0.0805266872048378, 0.041590478271245956, "
                            "0.012736065313220024, -0.0287811029702425, 0.06061254069209099, "
                            "-0.02171787992119789, -0.018373452126979828, 0.05638515576720238, "
                            "0.025468867272138596, 0.07004691660404205, 0.0022947711404412985, "
                            "-0.03663176670670509]});")
                    ->isSuccess());
    ASSERT_TRUE(conn->query("CREATE (b:Book {title: 'Echoes of the Past', published_year: 2015, "
                            "title_embedding: [-0.049829818308353424, 0.033521562814712524, "
                            "0.06205955892801285, 0.016005992889404297, 0.028101908043026924, "
                            "0.0782713070511818, -0.018612774088978767, -0.0944574847817421, "
                            "0.04298867657780647, -0.07435286045074463, -0.0374951995909214, "
                            "0.08019931614398956, -0.025469431653618813, -0.030850056558847427, "
                            "-0.059029050171375275, 0.016611216589808464, -0.0505402572453022, "
                            "0.03689393028616905, -0.006885590963065624, -0.05113375559449196, "
                            "-0.10299316048622131, 0.04054519161581993, -0.020479191094636917, "
                            "0.010960507206618786, 0.07412164658308029, 0.09663590043783188, "
                            "-0.004182497039437294, -0.019398367032408714, -0.02968374639749527, "
                            "-0.08110318332910538, 0.021700847893953323, 0.013743014074862003, "
                            "-0.0485922247171402, -0.049010489135980606, 0.05331917852163315, "
                            "0.010039267130196095, 0.010204819962382317, 0.05916183814406395, "
                            "0.05335807427763939, -0.03462529554963112, 0.048009634017944336, "
                            "-0.0033161663450300694, -0.023944975808262825, -0.015495670028030872, "
                            "-0.08585570752620697, -0.029174726456403732, -0.017741519957780838, "
                            "-0.028283527120947838, 0.0006337004015222192, 0.054429881274700165, "
                            "0.0024538899306207895, -0.009256032295525074, 0.013454730622470379, "
                            "-0.03683608025312424, 0.01927657052874565, 0.06098366528749466, "
                            "0.06529125571250916, 0.06995820999145508, -0.0016207601875066757, "
                            "-0.04693421721458435, -0.009298351593315601, -0.04289744421839714, "
                            "-0.10349273681640625, 0.027988340705633163, -0.026230888441205025, "
                            "0.002188182668760419, -0.023364916443824768, -0.021737180650234222, "
                            "0.01539772842079401, 0.057336386293172836, -0.006545454263687134, "
                            "0.06671825796365738, 0.0219378974288702, -0.09514465183019638, "
                            "-0.021967599168419838, -0.01747877523303032, -0.022128386422991753, "
                            "-0.11620887368917465, -0.05508462339639664, -0.05319182574748993, "
                            "0.03852409869432449, 0.01565507985651493, -0.039601728320121765, "
                            "0.014481494203209877, -0.014339200221002102, 0.002812053309753537, "
                            "-0.004119334742426872, -0.03752082586288452, 0.026112116873264313, "
                            "0.03825734555721283, 0.028098952025175095, -0.11066631227731705, "
                            "-0.021802358329296112, 0.07084450125694275, 0.02677907608449459, "
                            "-0.025543907657265663, 0.008241955190896988, 0.07894962280988693, "
                            "0.023746998980641365, 0.17455752193927765, -0.01415850967168808, "
                            "-0.017496686428785324, -0.01136754173785448, 0.01169698964804411, "
                            "0.025091808289289474, -0.08921273797750473, -0.048899583518505096, "
                            "-0.011359460651874542, -0.04401940852403641, -0.0006807204335927963, "
                            "-0.07878421247005463, -0.06317903101444244, -0.05290203168988228, "
                            "0.03278819099068642, 0.03515242785215378, -0.12314235419034958, "
                            "-0.016430191695690155, -0.047401297837495804, -0.10985466837882996, "
                            "0.02420021779835224, 0.03364190086722374, 0.03993738070130348, "
                            "-0.016756804659962654, 0.012074961327016354, -0.05076328292489052, "
                            "-0.0477975569665432, -0.015278595499694347, -5.547384858876877e-33, "
                            "0.05734722688794136, -0.015329951420426369, -0.02877618744969368, "
                            "0.0222267247736454, 0.06263111531734467, 0.04289969429373741, "
                            "-0.06580822914838791, -0.00033765562693588436, 0.0027139291632920504, "
                            "-0.05425131320953369, -0.01130084227770567, 0.032028574496507645, "
                            "-0.01900440640747547, -0.07120618969202042, -0.04863034188747406, "
                            "0.010090948082506657, -0.11319287866353989, 0.08012355118989944, "
                            "0.11442726850509644, -0.050888244062662125, -0.05253393575549126, "
                            "0.06781431287527084, -0.004743307363241911, -0.06838257610797882, "
                            "0.0019815678242594004, -0.042531080543994904, 0.003677906235679984, "
                            "0.05118786543607712, -0.010988974943757057, 0.04907194525003433, "
                            "-0.009429159574210644, 0.017635520547628403, 0.04537437856197357, "
                            "-0.07800577580928802, 0.03431670367717743, 0.09200435131788254, "
                            "0.03393590450286865, -0.05183374136686325, 0.019061146304011345, "
                            "0.02884541265666485, 0.029994195327162743, -0.009610540233552456, "
                            "-0.04680147022008896, -0.05055063217878342, 0.02104988321661949, "
                            "0.034783728420734406, -0.007372861262410879, 0.027524050325155258, "
                            "-0.0608983188867569, 0.007837689481675625, 0.005986157804727554, "
                            "-0.021691197529435158, -0.02833680994808674, -0.045740772038698196, "
                            "0.02475290186703205, -0.01997220702469349, 0.06052830070257187, "
                            "-0.0038910892326384783, 0.015039287507534027, 0.020947882905602455, "
                            "0.14144767820835114, -0.01288514118641615, 0.07050911337137222, "
                            "-0.013816284947097301, -0.0091706532984972, 0.0367070771753788, "
                            "-0.04654634743928909, -0.09691143035888672, 0.004264346323907375, "
                            "0.011247937567532063, -0.05037016421556473, 0.0008612120291218162, "
                            "-0.01736561954021454, 0.030969059094786644, 0.06777948886156082, "
                            "0.01855251006782055, -0.032436955720186234, 0.06876268237829208, "
                            "-0.02588762901723385, -0.012833813205361366, -0.06599952280521393, "
                            "-0.05716371536254883, -0.09261471033096313, 0.03469172120094299, "
                            "0.10092685371637344, 0.018187178298830986, 0.008830211125314236, "
                            "-0.10030726343393326, -0.035882629454135895, 0.05222763493657112, "
                            "-0.07635755836963654, 0.017777640372514725, 0.11377700418233871, "
                            "-0.08258559554815292, -0.09647741913795471, 2.656261645817246e-33, "
                            "-0.06169695779681206, 0.07473428547382355, 0.0010317993583157659, "
                            "0.04574477672576904, 0.00473462650552392, -0.03314993157982826, "
                            "-0.04266307130455971, 0.06361094862222672, -0.05770557001233101, "
                            "-0.015766579657793045, -0.037556663155555725, -0.0028808859642595053, "
                            "0.09332036226987839, 0.03768530488014221, -0.03884696960449219, "
                            "-0.03878059983253479, 0.11839576065540314, -0.05249686911702156, "
                            "0.010142767801880836, -0.007923844270408154, 0.002336277160793543, "
                            "-0.02902815490961075, -0.005442402325570583, -0.04996155947446823, "
                            "0.05269758775830269, 0.028989823535084724, 0.08379565924406052, "
                            "-0.027859194204211235, -0.06559368968009949, -0.027631668373942375, "
                            "-0.02569246105849743, -0.0020901060197502375, 0.028391484171152115, "
                            "0.04886195436120033, -0.03782598674297333, 0.07380025088787079, "
                            "0.09363154321908951, 0.028518911451101303, -0.013262958265841007, "
                            "-0.08243543654680252, -0.0038284710608422756, 0.022992869839072227, "
                            "0.011108619160950184, 0.0025643690023571253, -0.04426323622465134, "
                            "0.021387854591012, 0.007685762830078602, 0.13830095529556274, "
                            "0.07738806307315826, -0.0035209283232688904, -0.008818871341645718, "
                            "-0.005999668035656214, 0.04107915610074997, 0.021091068163514137, "
                            "-0.0014180467696860433, 0.017376849427819252, -0.002805901225656271, "
                            "-0.04047981649637222, 0.07535464316606522, 0.05046509951353073, "
                            "-0.054414015263319016, 0.053641028702259064, -0.09554356336593628, "
                            "-0.07607227563858032, 0.006706295069307089, -0.018187399953603745, "
                            "-0.013741839677095413, -0.03523123264312744, -0.06534004211425781, "
                            "0.049490343779325485, 0.03785886615514755, -0.05453720688819885, "
                            "-0.12872116267681122, 0.059172600507736206, 0.0002900145191233605, "
                            "0.052305035293102264, -0.09036772698163986, 0.0632234662771225, "
                            "-0.04788321629166603, -0.004830778576433659, -0.05894828587770462, "
                            "-0.0410018153488636, -0.0015975935384631157, 0.058311399072408676, "
                            "0.03303248807787895, 0.08007696270942688, -0.013939529657363892, "
                            "-0.0630728155374527, 0.08002451062202454, 0.0026970761828124523, "
                            "-0.002693860325962305, 0.0038479650393128395, 0.0008185034967027605, "
                            "0.015692155808210373, -0.003669170429930091, -1.475044975052242e-08, "
                            "-0.0036446007434278727, -0.046969760209321976, -0.004543432965874672, "
                            "0.014579894952476025, 0.013673532754182816, -0.023387782275676727, "
                            "0.10962412506341934, 0.011376280337572098, -0.020600901916623116, "
                            "0.02960311248898506, 0.030322367325425148, -0.01651306264102459, "
                            "0.04408107325434685, 0.02026151306927204, 0.06947655230760574, "
                            "-0.004552045371383429, 0.03369070217013359, -0.09677666425704956, "
                            "-0.06668055802583694, -0.06093839555978775, 0.041910409927368164, "
                            "0.0743514895439148, 0.03736606240272522, -0.08022662252187729, "
                            "0.0018126057693734765, 0.02723780646920204, -0.04909893870353699, "
                            "-0.02478020451962948, -0.03564610704779625, 0.06565092504024506, "
                            "0.05845369026064873, 0.11280028522014618, -0.029126863926649094, "
                            "-0.07232213765382767, -0.03022993728518486, -0.07852217555046082, "
                            "0.01916286163032055, 0.026670541614294052, -0.01400845218449831, "
                            "-0.018854964524507523, 0.02213193103671074, 0.02767794579267502, "
                            "0.04049822315573692, 0.022700484842061996, 0.01347304880619049, "
                            "0.010484214872121811, 0.10329107195138931, -0.02345561794936657, "
                            "-0.021265767514705658, 0.006645385641604662, 0.10781863331794739, "
                            "0.05482737720012665, 0.13701264560222626, 0.050267916172742844, "
                            "0.045667603611946106, -0.018383482471108437, 0.03138531371951103, "
                            "0.038462258875370026, -0.10793953388929367, -0.006006651092320681, "
                            "0.11764805763959885, 0.02336927503347397, 0.04825114086270332, "
                            "-0.019971977919340134]});")
                    ->isSuccess());
    ASSERT_TRUE(
        conn->query("CREATE (b:Book {title: 'The Dragon\\'s Call', published_year: 2019, "
                    "title_embedding: [-0.18540170788764954, 0.06793659180402756, "
                    "-0.007469308562576771, 0.023831220343708992, -0.11089251190423965, "
                    "-0.004015866667032242, 0.12233404070138931, 0.006930300034582615, "
                    "0.09582553058862686, -0.08186539262533188, -0.06665359437465668, "
                    "0.0020993410144001245, -0.060916513204574585, -0.015754902735352516, "
                    "-0.017249738797545433, -0.0030509501229971647, 0.021514253690838814, "
                    "-0.01356330793350935, -0.03888407722115517, 0.022119110450148582, "
                    "0.04286836460232735, 0.05288395658135414, 0.038437094539403915, "
                    "-0.0040170676074922085, -0.0033594921696931124, -0.14902086555957794, "
                    "-0.023836812004446983, 0.040612608194351196, 0.04794548824429512, "
                    "-0.05314237251877785, 0.03010483644902706, 0.11759684979915619, "
                    "-0.01050379779189825, 0.06385830789804459, -0.11309892684221268, "
                    "0.06324466317892075, -0.021218763664364815, -0.06262227147817612, "
                    "-0.016711629927158356, 0.06544151157140732, 0.022582951933145523, "
                    "-0.0004995755734853446, -0.0513993464410305, 0.0060507128946483135, "
                    "-0.008794000372290611, -0.0011558699188753963, -0.059460271149873734, "
                    "-0.0300544872879982, 0.025927232578396797, -0.023487672209739685, "
                    "-0.019863976165652275, -0.004302727058529854, -0.009071486070752144, "
                    "-0.03669297695159912, 0.055743683129549026, 0.021019412204623222, "
                    "0.032529063522815704, -0.07781179994344711, 0.04253167286515236, "
                    "0.02219802886247635, -0.004361358936876059, 0.0699595957994461, "
                    "-0.002493153791874647, 0.097707599401474, -0.06688143312931061, "
                    "0.034588076174259186, -0.02002084255218506, 0.03157343342900276, "
                    "0.022133005782961845, 0.030727649107575417, -0.0160380806773901, "
                    "0.01783960685133934, -0.017200643196702003, -0.07234548777341843, "
                    "-0.01971028931438923, -0.06489986181259155, -0.02517690323293209, "
                    "-0.18273134529590607, -0.04849505051970482, -0.034121885895729065, "
                    "-0.05462735518813133, -0.05910356715321541, -0.03181949630379677, "
                    "0.029557205736637115, 0.04644671827554703, 0.059074509888887405, "
                    "0.026310570538043976, 0.02439062111079693, 0.010542541742324829, "
                    "0.02750909887254238, -0.04061456769704819, -0.0723632425069809, "
                    "-0.009500962682068348, 0.09496299177408218, -0.12160974740982056, "
                    "0.041446126997470856, 0.08369731903076172, -0.11578401923179626, "
                    "-0.0409170426428318, 0.11262953281402588, -0.04022254794836044, "
                    "0.026385417208075523, -0.01517981756478548, -0.042340658605098724, "
                    "0.05180928111076355, -0.05344818904995918, -0.00999092310667038, "
                    "-0.03921341523528099, -0.029889261350035667, -0.01633119210600853, "
                    "0.005710989702492952, -0.07107365876436234, 0.005657616537064314, "
                    "0.02752622403204441, 0.016764221712946892, -0.046051379293203354, "
                    "0.0209773238748312, -0.006337829865515232, 0.06426346302032471, "
                    "-0.011234641075134277, 0.03659902513027191, 0.06275558471679688, "
                    "-0.07312791049480438, 0.00669202022254467, -0.05553030967712402, "
                    "-0.031081847846508026, 0.023442624136805534, -8.1543925567107e-33, "
                    "0.015707598999142647, -0.03638015687465668, 0.04493729770183563, "
                    "0.02803788334131241, 0.052681971341371536, -0.018984831869602203, "
                    "-0.026688436046242714, -0.024436915293335915, 0.0058840010315179825, "
                    "0.05062147602438927, -0.0855027586221695, -0.02399306930601597, "
                    "0.00262096943333745, -0.05143619328737259, 0.053300973027944565, "
                    "0.04715210944414139, -0.05588791146874428, 0.035333581268787384, "
                    "0.005380567163228989, 0.04078201949596405, 0.022275423631072044, "
                    "0.08810155093669891, 0.02310004085302353, -0.07213450223207474, "
                    "0.03153090178966522, -0.0596754252910614, -0.016961943358182907, "
                    "0.010798824019730091, 0.059033192694187164, 0.02176986075937748, "
                    "-0.027517622336745262, -0.03293217718601227, 0.01868797093629837, "
                    "0.0295332632958889, 0.03122459538280964, 0.03517952561378479, "
                    "-0.014694235287606716, -0.03302743658423424, -0.05088328942656517, "
                    "0.00630725733935833, -0.004285559989511967, 0.05811944603919983, "
                    "-0.13368593156337738, 0.0047440496273338795, -0.0017785675590857863, "
                    "0.0808911845088005, -0.0308091938495636, 0.036151446402072906, "
                    "-0.04590032994747162, 0.04771047085523605, -0.0019055446609854698, "
                    "0.04752719774842262, 0.06425806134939194, 0.04700439050793648, "
                    "-0.08454781025648117, -0.03551812842488289, 0.030094901099801064, "
                    "-0.03009708970785141, -0.002514246618375182, -0.0019370022928342223, "
                    "0.04097996652126312, -0.07419604808092117, 0.007340343203395605, "
                    "0.029307467862963676, 0.04389327019453049, 0.0017895223572850227, "
                    "-0.03778468072414398, 0.005756417289376259, -0.008426757529377937, "
                    "-0.10337523370981216, -0.03211952745914459, 0.021602651104331017, "
                    "0.021470727398991585, -0.014701959677040577, 0.06818022578954697, "
                    "-0.05729447677731514, -0.06868518888950348, -0.06216307356953621, "
                    "-0.08584676682949066, 0.02235088124871254, 0.032364122569561005, "
                    "-0.03831927478313446, -0.030235283076763153, 0.020644040778279305, "
                    "0.07121783494949341, 0.039326004683971405, 0.08768510818481445, "
                    "-0.06786059588193893, -0.01706608757376671, 0.06446389108896255, "
                    "-0.06721138954162598, -0.0504893995821476, 0.03251216188073158, "
                    "-0.055399470031261444, -0.0013445437652990222, 5.3164435652944844e-33, "
                    "-0.05026233568787575, -0.05378647521138191, 0.008323297835886478, "
                    "0.03267786279320717, 0.04952056333422661, -0.06648965179920197, "
                    "0.022101417183876038, 0.06676041334867477, -0.0571901910007, "
                    "0.043427206575870514, -0.029885536059737206, 0.03177806735038757, "
                    "0.07152712345123291, 0.02875991351902485, 0.06779032945632935, "
                    "-0.022996556013822556, 0.04914144426584244, 0.02911580540239811, "
                    "-0.0207993034273386, 0.06416968256235123, 0.008019614033401012, "
                    "-0.05215483903884888, -0.06548760086297989, 0.022110210731625557, "
                    "-0.008426225744187832, 0.07603684067726135, -0.022800516337156296, "
                    "-0.05929452180862427, 0.021286461502313614, -0.028060391545295715, "
                    "-0.040567610412836075, 0.010529166087508202, 0.012379053980112076, "
                    "0.0712088942527771, -0.030132891610264778, 0.04145849123597145, "
                    "0.047829803079366684, 0.020461061969399452, -0.008220324292778969, "
                    "-0.04280165582895279, 0.10941748321056366, -0.060646746307611465, "
                    "-0.03681674227118492, 0.07633225619792938, -0.01496896892786026, "
                    "0.02178552746772766, 0.009385869838297367, 0.07547357678413391, "
                    "-0.048568934202194214, -0.06040945276618004, -0.0441485159099102, "
                    "0.028183571994304657, -0.000641089805867523, 0.03396526351571083, "
                    "0.05434730276465416, 0.013001580722630024, 0.021906521171331406, "
                    "-0.07054643332958221, 0.051582951098680496, 0.02543145790696144, "
                    "-0.005555190611630678, 0.009509721770882607, -0.005496333818882704, "
                    "-0.025545582175254822, -0.029836393892765045, 0.08880407363176346, "
                    "0.020335735753178596, -0.04089493677020073, 0.08322391659021378, "
                    "-0.07547427713871002, -0.016970666125416756, 0.09265976399183273, "
                    "-0.09279859811067581, -0.06843513250350952, -0.03042486682534218, "
                    "0.03477191925048828, -0.08628556877374649, -0.026261238381266594, "
                    "-0.007645647972822189, -0.02307489514350891, -0.023042630404233932, "
                    "-0.10216541588306427, 0.03313450887799263, 0.08414570242166519, "
                    "0.04367329552769661, 0.01524174865335226, 0.06284227222204208, "
                    "0.01941118761897087, -0.06788983941078186, -0.04734581336379051, "
                    "0.0390169620513916, 0.06093113496899605, 0.03812161087989807, "
                    "0.012651454657316208, 0.018506895750761032, -1.53982604444991e-08, "
                    "-0.03505414351820946, 0.05272769555449486, 0.05954147130250931, "
                    "-0.03765067830681801, 0.0034149051643908024, 0.0415261909365654, "
                    "0.015893157571554184, -0.01961718313395977, -0.0037990370765328407, "
                    "0.054007988423109055, 0.01690937951207161, 0.024796269834041595, "
                    "0.04454779252409935, 0.08668481558561325, 0.036989808082580566, "
                    "0.060952723026275635, 0.04871708154678345, -0.08704926073551178, "
                    "-0.02028338797390461, -0.0125207444652915, -0.04476867988705635, "
                    "-0.03101368620991707, 0.05608799308538437, -0.025605443865060806, "
                    "-0.06816127896308899, 0.024253906682133675, -0.04644269123673439, "
                    "0.060038186609745026, 0.0720129907131195, -0.026175791397690773, "
                    "0.06023845821619034, 0.05419669672846794, -0.06058764457702637, "
                    "0.06647701561450958, 0.0276230089366436, -0.0015889834612607956, "
                    "-0.06511609256267548, -0.014419924467802048, 0.08967186510562897, "
                    "-0.07286196947097778, -0.022456035017967224, 0.02639768272638321, "
                    "0.02058306522667408, 0.08120265603065491, 0.05085141584277153, "
                    "-0.03734622523188591, 0.052662286907434464, -0.09020519256591797, "
                    "0.026162827387452126, -0.057903457432985306, 0.07977279275655746, "
                    "-0.048131681978702545, 0.052649520337581635, 0.003550753928720951, "
                    "0.00952476542443037, 0.06290005892515182, -0.058000244200229645, "
                    "0.024111026898026466, -0.15407536923885345, 0.04837105795741081, "
                    "0.008960545063018799, -0.0170251727104187, -0.03021182306110859, "
                    "0.06328440457582474]});")
            ->isSuccess());
    ASSERT_TRUE(
        conn->query("CALL CREATE_VECTOR_INDEX('Book', 'title_vec_index', 'title_embedding');")
            ->isSuccess());
    auto prepared = conn->prepare(
        "CALL QUERY_VECTOR_INDEX('Book', 'title_vec_index', [-0.09874727576971054, "
        "-0.019663318991661072, 0.026379680261015892, 0.03300049901008606, -0.08525621145963669, "
        "0.03913292661309242, -0.008519773371517658, -0.10472023487091064, -0.07655946910381317, "
        "-0.02551322802901268, -0.008726594969630241, -0.004044667351990938, "
        "-0.034863777458667755, 0.019577588886022568, -0.053255144506692886, 0.06925362348556519, "
        "0.005541415419429541, -0.007712417747825384, -0.04724293202161789, -0.07092397660017014, "
        "-0.00885140523314476, 0.057485658675432205, -0.01551036350429058, 0.007519498933106661, "
        "0.08363034576177597, -0.011691797524690628, 0.07842060178518295, 0.0699118822813034, "
        "0.03983190655708313, -0.04736096411943436, 0.05344963073730469, 0.018938563764095306, "
        "-0.007491335738450289, -0.06082497537136078, -0.0507962740957737, 0.04239414632320404, "
        "-0.018963998183608055, 0.007558973040431738, 0.042515095323324203, -0.026247873902320862, "
        "0.04227885231375694, 0.031660303473472595, -0.04580925032496452, 0.030136926099658012, "
        "0.06916909664869308, 0.1163673847913742, 0.08413344621658325, 0.00152504607103765, "
        "-0.024930620566010475, -0.10900826007127762, -0.055435676127672195, 0.034742217510938644, "
        "-0.0032851770520210266, 0.0435388945043087, 0.006796618457883596, "
        "-0.00048406978021375835, 0.07152412086725235, -0.01019048597663641, -0.03555936738848686, "
        "-0.06622810661792755, -0.025580912828445435, -0.09381087869405746, -0.09504663944244385, "
        "0.02437695302069187, 0.134092777967453, 0.027306102216243744, -0.013635482639074326, "
        "0.04523690044879913, -0.045877039432525635, -0.010559560731053352, -0.034854717552661896, "
        "-0.01888713240623474, -0.045843612402677536, 0.023764878511428833, 0.061249908059835434, "
        "-0.039338767528533936, 0.07242103666067123, 0.0527820959687233, 0.043525248765945435, "
        "-0.0003186847607139498, -0.02600417472422123, -0.10006128996610641, 0.016926968470215797, "
        "0.008328817784786224, 0.09273956716060638, 0.019676057621836662, -0.08953194320201874, "
        "0.006387700792402029, -0.081199049949646, -0.06670287251472473, -0.0417928621172905, "
        "-0.045379575341939926, -0.0008021353278309107, -0.09036444127559662, "
        "-0.029995467513799667, 0.029478128999471664, 0.026864662766456604, -0.06496299803256989, "
        "0.012791202403604984, 0.09779316186904907, 0.03545205295085907, 0.04149294272065163, "
        "0.019831914454698563, 0.002529511693865061, 0.0461372546851635, -0.008579960092902184, "
        "0.026133403182029724, 0.01814635843038559, 0.07846872508525848, -0.09352493286132812, "
        "0.022968290373682976, 0.01182691939175129, 0.012175423093140125, -0.004965497180819511, "
        "7.896034367149696e-05, -0.021726293489336967, 0.036760929971933365, 0.08447402715682983, "
        "-0.046395111829042435, 0.05701972171664238, -0.050493594259023666, 6.76907438901253e-05, "
        "-0.002953510032966733, 0.0860934630036354, -0.02953658252954483, -0.03056415542960167, "
        "-0.12899217009544373, -2.064106550261511e-33, 0.015488152392208576, -0.03342021629214287, "
        "0.015619009733200073, -0.010455731302499771, 0.05864442139863968, -0.02653684839606285, "
        "0.07258284837007523, -0.08778553456068039, 0.018826346844434738, -0.016216641291975975, "
        "-0.007404595613479614, -0.03554968908429146, 0.008319997228682041, -0.02855130471289158, "
        "0.03193259984254837, 0.018047798424959183, -0.06740124523639679, -0.007899004966020584, "
        "0.03631879389286041, -0.02133457362651825, 0.04704872891306877, -0.05590340495109558, "
        "-0.045616090297698975, 0.021392134949564934, -0.07849449664354324, -0.023068571463227272, "
        "0.11903978884220123, -0.0018944559851661325, -0.04567766189575195, 0.008722291328012943, "
        "0.006837415508925915, 0.07824835181236267, -0.08694804459810257, -0.005149406846612692, "
        "0.0592142678797245, 0.020647693425416946, 0.019302235916256905, 0.05669999122619629, "
        "0.004759966395795345, -0.06363297998905182, -0.03863728791475296, -0.07707936316728592, "
        "0.06844320148229599, -0.005478093400597572, -0.020625025033950806, 0.0005605336045846343, "
        "0.02365974709391594, -0.0857347846031189, 0.0040472401306033134, -0.02703179605305195, "
        "0.07371301203966141, -0.08515466749668121, -0.05958851799368858, -0.00036977347917854786, "
        "0.045746318995952606, 0.037566229701042175, 0.037339646369218826, 0.01565920189023018, "
        "-0.029106922447681427, -0.026880435645580292, 0.02145109511911869, 0.020097855478525162, "
        "0.004611643496900797, 0.05472870543599129, -0.016886215656995773, 0.06590874493122101, "
        "0.013731150887906551, -0.018520070239901543, 0.003863745369017124, 0.09537586569786072, "
        "0.006862230598926544, 0.04087948799133301, 0.048243604600429535, -0.07596695423126221, "
        "0.08784883469343185, -0.04977760463953018, -0.01720358058810234, -0.04158437252044678, "
        "-0.007139154709875584, 0.005755842197686434, -0.005658647511154413, -0.03917710483074188, "
        "-0.047673579305410385, 0.022293440997600555, -0.02965836226940155, -0.1400938630104065, "
        "-0.06738895922899246, -0.06697329133749008, -0.016933375969529152, "
        "-0.0017664943588897586, -0.0932610034942627, -0.024097386747598648, 0.11550511419773102, "
        "0.05578150972723961, -0.12074088305234909, 1.1273514286713838e-33, -0.11707723885774612, "
        "0.07049695402383804, 0.03651612997055054, 0.06814820319414139, -0.021599706262350082, "
        "-0.01940377987921238, -0.02033681608736515, -0.011085398495197296, -0.00800390262156725, "
        "0.05900853872299194, 0.05606481805443764, 0.07885222882032394, 0.08607453852891922, "
        "0.05710339546203613, -0.04390961676836014, 0.09391780197620392, 0.022916318848729134, "
        "-0.01837819069623947, 0.06715855002403259, 0.012958995997905731, 0.0018168555106967688, "
        "0.009906788356602192, 0.028201734647154808, -0.014642609283328056, 0.02585628256201744, "
        "0.058014560490846634, 0.05878483131527901, 0.03323346748948097, 0.026972956955432892, "
        "-0.03851533681154251, 0.011257020756602287, -0.10183282196521759, -0.06838149577379227, "
        "0.02577545866370201, -0.09795572608709335, 0.03309926018118858, 0.02638947032392025, "
        "0.038076382130384445, 0.0023347269743680954, 0.025551890954375267, -0.034650497138500214, "
        "-0.01582970656454563, -0.08356215059757233, -0.009231070056557655, 0.004009858705103397, "
        "-0.036289189010858536, 0.003509229514747858, 0.011391056701540947, -0.061331845819950104, "
        "0.01540123950690031, -0.0011264500208199024, 0.10097002238035202, -0.013182193972170353, "
        "0.011979017406702042, -0.13199655711650848, 0.02036047913134098, -0.017511453479528427, "
        "0.05499761179089546, 0.11070820689201355, 0.014930548146367073, -0.09360553324222565, "
        "-0.019297722727060318, 0.007204619701951742, 0.09441079944372177, -0.00927896611392498, "
        "-0.04180166870355606, -0.04578719288110733, 0.05872377008199692, 0.03292301297187805, "
        "-0.020148921757936478, -0.034446872770786285, 0.024236811324954033, 0.021329764276742935, "
        "-0.01295411866158247, 0.019372068345546722, -0.007271720562130213, -0.019697433337569237, "
        "-0.053335949778556824, -0.011210829950869083, -0.0036429560277611017, "
        "0.018726753070950508, -0.01846127398312092, -0.026368536055088043, 0.06836844235658646, "
        "0.03631875663995743, 0.04551452025771141, 0.09708166867494583, -0.0013076072791591287, "
        "0.038096629083156586, -0.07843992859125137, 0.02037520334124565, 0.04456569254398346, "
        "0.026434291154146194, -0.032406117767095566, -0.03527767211198807, "
        "-1.0356031587832604e-08, -0.017991339787840843, -0.038019757717847824, "
        "0.046414148062467575, -0.04335968568921089, 0.13680949807167053, 0.01109931617975235, "
        "0.004367447458207607, 0.018392788246273994, -0.07819430530071259, -0.05922280624508858, "
        "0.02490466833114624, -0.024358082562685013, -0.06704910099506378, 0.02667614072561264, "
        "0.03479555994272232, 0.027538081631064415, -0.02667420543730259, -0.010268918238580227, "
        "-0.004408948123455048, 0.01541890762746334, 0.09345494210720062, 0.03375879302620888, "
        "0.0555303655564785, 0.02469305880367756, 0.009483843110501766, -0.057700056582689285, "
        "-0.03969407081604004, 0.0016294082161039114, 0.02770363539457321, 0.08777989447116852, "
        "-0.07391007244586945, 0.07368578761816025, 0.07130586355924606, 0.05937817692756653, "
        "-0.029533831402659416, -0.008655997924506664, -0.010082626715302467, -0.0797964483499527, "
        "-0.025537142530083656, 0.0783148780465126, -0.06385865062475204, 0.059156548231840134, "
        "-0.0749022364616394, 0.0023516560904681683, 0.0034361558500677347, 0.003786548040807247, "
        "0.05568376183509827, -0.09200930595397949, 0.09327029436826706, 0.08218848705291748, "
        "0.07302675396203995, 0.02313903532922268, 0.0677151307463646, -0.0498654730618, "
        "0.0007056242320686579, 0.07477487623691559, 0.008759301155805588, -0.06420709192752838, "
        "-0.035795655101537704, 0.053932011127471924, 0.031011711806058884, 0.025613466277718544, "
        "-0.036662112921476364, -0.008528689853847027], $k) RETURN node.title ORDER BY distance;");
    auto preparedResult = TestHelper::convertResultToString(
        *conn->execute(prepared.get(), std::make_pair(std::string("k"), 2)));
    auto expectedResult = std::vector<std::string>{"The Quantum World", "Learning Machines"};
    sortAndCheckTestResults(preparedResult, expectedResult);
}

} // namespace testing
} // namespace kuzu
