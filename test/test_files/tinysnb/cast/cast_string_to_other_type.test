-GROUP TinySnbReadTest
-DATASET CSV load-from-test

--

-CASE CastStringToList
-STATEMENT LOAD WITH HEADERS (list INT64[][], a struct(num INT64, str STRING)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/should_pass.csv" RETURN *;
---- 7
[[1,3,423,124,43242],[432]]|{num: -423432, str: this is a string []}
[[1,3,423,124,43242],[432]]|{num: 3423423, str: this is a string}
[[1,3,423,124,43242],[432]]|{num: 3424231143, str: this is a normal string no space ' , , does not count'}
[,[],[1,2,3]]|{num: 0, str: this is a string}
[,,,,,,,,,,[1,2,3]]|{num: 1, str: yes}
[[],[],[]]|{num: 2341, str: no}
[,,]|{num: 0, str: }
-STATEMENT LOAD WITH HEADERS (list STRING[], str STRING, struct STRUCT(a STRUCT(b STRUCT(c INT64[])))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/change_config.csv" (HEADER=true, DELIM="|", ESCAPE="~", QUOTE="'", LIST_BEGIN="(", LIST_END=")") RETURN * ;
---- 3
[escape , is escape success? ~]| ' ( ) do not need to escape sepeical | ()|{a: {b: {c: []}}}
[this , is a word , normal not escape , ' ( ) | , ~ ' ]|try escape ~|{a: {b: {c: [3432423,-43423,31231,]}}}
[~ ' not work also this '"" ]|nu|{a: {b: {c: []}}}
-STATEMENT LOAD WITH HEADERS (map MAP(STRING, MAP(STRING, INT16))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/nested_map_correct.csv" RETURN *;
---- 3
{c={a=3423}, b={g=3421}}
{d={}}
{}
-STATEMENT LOAD WITH HEADERS (map MAP(INT32[], STRUCT(c STRING))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/map_correct.csv" (HEADER=true, DELIM=">") RETURN *;
---- 6
{[432,24,12]={c: okay}, [90,11,43,54]={c: bad}, [0]={c: good}}
{[]={c: }}
{[11,43,]={c: this is a struct}}
{[]={c: this is not empty}}
{[1000,143245,432,43241,-43214324,-432423,-4324324,-41412,-131242143,0,-4324324,0]={c: }}
{={c: '~~ have some > >'}}
-STATEMENT LOAD WITH HEADERS (map MAP(MAP(INT64, INT64), MAP(STRING, STRING))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/nested_map2.csv" RETURN *;
---- 7
{{18046=18046, 2=321, 3=423421}={dJ3cf6Y=dJ3cf6Y, dJ3cf6Y=dJ3cf6Y, dJ3cf6Y=dJ3cf6Y}}
{{30099=30099, 1=0}={3mTEf=3mTEf, 3mTEf=3mTEf, 3mTEf=3mTEf}}
{{31395=31395}={}}
{{}={YQcmYouhyFqD3y=YQcmYouhyFqD3y, YQcmYouhyFqD3y=YQcmYouhyFqD3y, YQcmYouhyFqD3y=YQcmYouhyFqD3y}}
{{}={}}
{=}
{}

-CASE ErrorTest
-STATEMENT LOAD WITH HEADERS (list STRING[][]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/delim_fail.csv" (DELIM="|", ESCAPE="~", QUOTE="'", LIST_BEGIN="(", LIST_END=")") RETURN * ;
---- error
Conversion exception: Cast failed. "((hello),(bdfadf),)" is not in STRING[][] range.
-STATEMENT LOAD WITH HEADERS (list STRING[][]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/bracket_fail.csv" (DELIM="|", ESCAPE="~", LIST_BEGIN="(", LIST_END=")") RETURN * ;
---- error
Conversion exception: Cast failed. (() is not in STRING[][] range.
-STATEMENT LOAD WITH HEADERS (list INT32[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/quote_fail.csv" RETURN * ;
---- error
Binder exception: Number of columns mismatch. Expected 1 but got 3.
-STATEMENT LOAD WITH HEADERS (list STRING[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/single_quote.csv" RETURN *;
---- error
Conversion exception: Cast failed. ['fdsfdsfe werw] is not in STRING[] range.
-STATEMENT LOAD WITH HEADERS (list STRING[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/single_quote2.csv" RETURN *;
---- error
Conversion exception: Cast failed. [[' this is a signle quote]] is not in STRING[] range.
-STATEMENT LOAD WITH HEADERS (list UINT8[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/single_struct.csv" RETURN *;
---- error
Conversion exception: Cast failed. [{32, 32] is not in UINT8[] range.
-STATEMENT LOAD WITH HEADERS (list UINT8[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/conversion_fail.csv" RETURN *;
---- error
Conversion exception: Cast failed. 432412 is not in UINT8 range.
-STATEMENT LOAD WITH HEADERS (q STRUCT(a STRUCT(b STRING))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_bracket_fail1.csv" RETURN *;
---- error
Conversion exception: Cast failed. {a: {b: fsdf is not in STRUCT(a:STRUCT(b:STRING)) range.
-STATEMENT LOAD WITH HEADERS (q STRUCT(a STRUCT(b STRING))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_bracket_fail2.csv" RETURN *;
---- error
Conversion exception: Cast failed. {a: {b: fds} is not in STRUCT(a:STRUCT(b:STRING)) range.
-STATEMENT LOAD WITH HEADERS (a STRUCT(c STRING)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_close_fail.csv" RETURN *;
---- error
Conversion exception: Cast failed. { c : 423 } c: 479, is not in STRUCT(c:STRING) range.
-STATEMENT LOAD WITH HEADERS (a STRUCT(c INT32)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/invalid_field_name.csv" RETURN *;
---- error
Parser exception: Invalid struct field name: d
-STATEMENT LOAD WITH HEADERS (a STRUCT(c INT32)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/no_field_name.csv" RETURN *;
---- error
Conversion exception: Cast failed. {c 3423} is not in STRUCT(c:INT32) range.
-STATEMENT LOAD WITH HEADERS (a STRUCT(c INT32)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_quote_fail.csv" RETURN *;
---- error
Conversion exception: Cast failed. { c: 'fdsfs } is not in STRUCT(c:INT32) range.
-STATEMENT LOAD WITH HEADERS (a STRUCT(c INT32)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_noclose.csv" RETURN *;
---- error
Conversion exception: Cast failed. { is not in STRUCT(c:INT32) range.
-STATEMENT LOAD WITH HEADERS (a MAP(UINT8, UINT8)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/map_incorrect_type.csv" RETURN *;
---- error
Conversion exception: Cast failed. -3 is not in UINT8 range.
-STATEMENT LOAD WITH HEADERS (a MAP(UINT8, UINT8)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/map_no_val.csv" RETURN *;
---- error
Conversion exception: Cast failed. {4324} is not in MAP(UINT8: UINT8) range.
-STATEMENT LOAD WITH HEADERS (a MAP(UINT8, UINT8)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/map_no_closing1.csv" RETURN *;
---- error
Conversion exception: Cast failed. {10=10, 20=20, is not in MAP(UINT8: UINT8) range.
-STATEMENT LOAD WITH HEADERS (a MAP(UINT8, UINT8)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/map_no_closing2.csv" RETURN *;
---- error
Conversion exception: Cast failed. { is not in MAP(UINT8: UINT8) range.
-STATEMENT LOAD WITH HEADERS (a MAP(STRING, UINT8)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/map_no_quote.csv" RETURN *;
---- error
Conversion exception: Cast failed. {324="} is not in MAP(STRING: UINT8) range.
-STATEMENT LOAD WITH HEADERS (a MAP(UINT8, UINT8)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/map_no_closing3.csv" RETURN *;
---- error
Conversion exception: Cast failed. {{3=3} is not in MAP(UINT8: UINT8) range.
-STATEMENT LOAD WITH HEADERS (a MAP(UINT16, UINT16[])) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/map_no_closing4.csv" RETURN *;
---- error
Conversion exception: Cast failed. {432=[432,432} is not in MAP(UINT16: UINT16[]) range.
